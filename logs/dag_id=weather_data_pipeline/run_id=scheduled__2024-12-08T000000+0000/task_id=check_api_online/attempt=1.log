[2024-12-09T16:06:39.615+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T16:06:39.813+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T16:06:39.830+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T16:06:39.832+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T16:06:39.858+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T16:06:39.866+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=5325) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T16:06:39.869+0000] {standard_task_runner.py:72} INFO - Started process 5327 to run task
[2024-12-09T16:06:39.870+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpis1y61s3']
[2024-12-09T16:06:39.872+0000] {standard_task_runner.py:105} INFO - Job 5: Subtask check_api_online
[2024-12-09T16:06:39.948+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T16:06:40.091+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T16:06:40.094+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T16:06:40.094+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T16:06:40.097+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 16:06:39.814667+00:00
[2024-12-09T16:06:40.098+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T16:06:40.099+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T16:06:40.629+0000] {python.py:240} INFO - Done. Returned value was: {'coord': {'lon': -122.6762, 'lat': 45.5234}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01d'}], 'base': 'stations', 'main': {'temp': 278.97, 'feels_like': 278.97, 'temp_min': 277.6, 'temp_max': 279.71, 'pressure': 1031, 'humidity': 96, 'sea_level': 1031, 'grnd_level': 1020}, 'visibility': 10000, 'wind': {'speed': 0.45, 'deg': 23, 'gust': 0}, 'clouds': {'all': 8}, 'dt': 1733760400, 'sys': {'type': 2, 'id': 2008548, 'country': 'US', 'sunrise': 1733758781, 'sunset': 1733790437}, 'timezone': -28800, 'id': 5746545, 'name': 'Portland', 'cod': 200}
[2024-12-09T16:06:40.677+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T16:06:40.679+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T160639, end_date=20241209T160640
[2024-12-09T16:06:40.703+0000] {logging_mixin.py:190} INFO - Task instance in success state
[2024-12-09T16:06:40.705+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: running
[2024-12-09T16:06:40.706+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline queued_at:2024-12-09 16:06:30.104826+00:00
[2024-12-09T16:06:40.707+0000] {logging_mixin.py:190} INFO - Task hostname:4ccd8b9315ad operator:PythonOperator
[2024-12-09T16:06:40.769+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2024-12-09T16:06:40.847+0000] {taskinstance.py:3895} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-12-09T16:06:40.863+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T18:34:50.731+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T18:34:50.764+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T18:34:50.782+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T18:34:50.783+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T18:34:50.824+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T18:34:50.836+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=223) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T18:34:50.841+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '34', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpctbnc_uy']
[2024-12-09T18:34:50.843+0000] {standard_task_runner.py:72} INFO - Started process 225 to run task
[2024-12-09T18:34:50.844+0000] {standard_task_runner.py:105} INFO - Job 34: Subtask check_api_online
[2024-12-09T18:34:50.989+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T18:34:51.637+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T18:34:51.644+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T18:34:51.646+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T18:34:51.649+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 18:34:50.765828+00:00
[2024-12-09T18:34:51.650+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T18:34:51.653+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T18:34:51.655+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T18:34:51.656+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T18:34:51.696+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T18:34:51.715+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T18:34:51.716+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 18:34:50.765828+00:00 end:2024-12-09 18:34:51.714766+00:00 duration:0.948938
[2024-12-09T18:34:51.717+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 18:34:46.984312+00:00. externally triggered: False>
[2024-12-09T18:34:51.718+0000] {logging_mixin.py:190} INFO - Failure caused by The conn_id `openweather_api` isn't defined
[2024-12-09T18:34:51.719+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T183450, end_date=20241209T183451
[2024-12-09T18:34:51.750+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T18:34:51.751+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 34 for task check_api_online (The conn_id `openweather_api` isn't defined; 225)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T18:34:51.794+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T18:34:51.834+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T18:34:51.838+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T18:41:40.032+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T18:41:40.054+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T18:41:40.064+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T18:41:40.065+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T18:41:40.081+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T18:41:40.088+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=131) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T18:41:40.090+0000] {standard_task_runner.py:72} INFO - Started process 133 to run task
[2024-12-09T18:41:40.091+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '40', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpaonztfxb']
[2024-12-09T18:41:40.092+0000] {standard_task_runner.py:105} INFO - Job 40: Subtask check_api_online
[2024-12-09T18:41:40.145+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T18:41:40.418+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T18:41:40.420+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T18:41:40.420+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T18:41:40.421+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 18:41:40.055228+00:00
[2024-12-09T18:41:40.421+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T18:41:40.422+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T18:41:40.423+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T18:41:40.423+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T18:41:40.442+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T18:41:40.452+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T18:41:40.453+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 18:41:40.055228+00:00 end:2024-12-09 18:41:40.452338+00:00 duration:0.39711
[2024-12-09T18:41:40.454+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 18:41:38.204570+00:00. externally triggered: False>
[2024-12-09T18:41:40.454+0000] {logging_mixin.py:190} INFO - Failure caused by The conn_id `openweather_api` isn't defined
[2024-12-09T18:41:40.455+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T184140, end_date=20241209T184140
[2024-12-09T18:41:40.473+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T18:41:40.474+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 40 for task check_api_online (The conn_id `openweather_api` isn't defined; 133)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T18:41:40.506+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T18:41:40.529+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T18:41:40.533+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T18:47:09.363+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T18:47:09.384+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T18:47:09.395+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T18:47:09.396+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T18:47:09.414+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T18:47:09.422+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=123) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T18:47:09.424+0000] {standard_task_runner.py:72} INFO - Started process 127 to run task
[2024-12-09T18:47:09.426+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '47', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmp1x0aobxs']
[2024-12-09T18:47:09.428+0000] {standard_task_runner.py:105} INFO - Job 47: Subtask check_api_online
[2024-12-09T18:47:09.495+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T18:47:09.982+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T18:47:09.983+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T18:47:09.984+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T18:47:09.984+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 18:47:09.385637+00:00
[2024-12-09T18:47:09.985+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T18:47:09.985+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T18:47:09.986+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T18:47:09.987+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T18:47:10.008+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T18:47:10.019+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T18:47:10.020+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 18:47:09.385637+00:00 end:2024-12-09 18:47:10.019465+00:00 duration:0.633828
[2024-12-09T18:47:10.021+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 18:47:06.645067+00:00. externally triggered: False>
[2024-12-09T18:47:10.021+0000] {logging_mixin.py:190} INFO - Failure caused by The conn_id `openweather_api` isn't defined
[2024-12-09T18:47:10.022+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T184709, end_date=20241209T184710
[2024-12-09T18:47:10.044+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T18:47:10.045+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 47 for task check_api_online (The conn_id `openweather_api` isn't defined; 127)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T18:47:10.083+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T18:47:10.112+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T18:47:10.115+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T19:12:30.499+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T19:12:30.522+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:12:30.536+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:12:30.537+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T19:12:30.563+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T19:12:30.573+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=453) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T19:12:30.576+0000] {standard_task_runner.py:72} INFO - Started process 459 to run task
[2024-12-09T19:12:30.577+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '54', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpojfpr8j4']
[2024-12-09T19:12:30.579+0000] {standard_task_runner.py:105} INFO - Job 54: Subtask check_api_online
[2024-12-09T19:12:30.654+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T19:12:31.375+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T19:12:31.377+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T19:12:31.382+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T19:12:31.383+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 19:12:30.523170+00:00
[2024-12-09T19:12:31.384+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T19:12:31.385+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T19:12:31.386+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T19:12:31.387+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:12:31.448+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T19:12:31.485+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T19:12:31.486+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 19:12:30.523170+00:00 end:2024-12-09 19:12:31.484901+00:00 duration:0.961731
[2024-12-09T19:12:31.487+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 19:12:27.740611+00:00. externally triggered: False>
[2024-12-09T19:12:31.496+0000] {logging_mixin.py:190} INFO - Failure caused by The conn_id `openweather_api` isn't defined
[2024-12-09T19:12:31.497+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T191230, end_date=20241209T191231
[2024-12-09T19:12:31.541+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T19:12:31.543+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 54 for task check_api_online (The conn_id `openweather_api` isn't defined; 459)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 306, in execute
    raise e
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 286, in execute
    poke_return = self.poke(context)
                  ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 154, in poke
    raise exc
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 139, in poke
    response = hook.run(
               ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 170, in run
    session = self.get_conn(headers)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/hooks/http.py", line 110, in get_conn
    conn = self.get_connection(self.http_conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/base.py", line 83, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 537, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `openweather_api` isn't defined
[2024-12-09T19:12:31.642+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T19:12:31.677+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T19:12:31.681+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T19:35:39.640+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T19:35:39.674+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:35:39.702+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:35:39.703+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T19:35:39.725+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T19:35:39.733+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=746) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T19:35:39.735+0000] {standard_task_runner.py:72} INFO - Started process 748 to run task
[2024-12-09T19:35:39.735+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '57', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmptctt4moz']
[2024-12-09T19:35:39.737+0000] {standard_task_runner.py:105} INFO - Job 57: Subtask check_api_online
[2024-12-09T19:35:39.800+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T19:35:40.188+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T19:35:40.189+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T19:35:40.190+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T19:35:40.191+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 19:35:39.675362+00:00
[2024-12-09T19:35:40.192+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T19:35:40.192+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T19:35:40.193+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T19:35:40.194+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:35:40.204+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:35:40.781+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:35:40.782+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:35:45.784+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:35:45.791+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:35:46.167+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:35:46.168+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:35:51.168+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:35:51.178+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:35:51.606+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:35:51.609+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:35:56.610+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:35:56.624+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:35:57.028+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:35:57.029+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:36:02.030+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:36:02.041+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:36:02.418+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:36:02.419+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:36:02.421+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 22.229901047998283 seconds exceeds the specified timeout of 20.0.
[2024-12-09T19:36:02.441+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T19:36:02.442+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 19:35:39.675362+00:00 end:2024-12-09 19:36:02.440672+00:00 duration:22.76531
[2024-12-09T19:36:02.443+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 19:35:37.432195+00:00. externally triggered: False>
[2024-12-09T19:36:02.444+0000] {logging_mixin.py:190} INFO - Failure caused by Sensor has timed out; run duration of 22.229901047998283 seconds exceeds the specified timeout of 20.0.
[2024-12-09T19:36:02.448+0000] {taskinstance.py:1225} INFO - Immediate failure requested. Marking task as FAILED. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T193539, end_date=20241209T193602
[2024-12-09T19:36:02.494+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T19:36:02.495+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 57 for task check_api_online (Sensor has timed out; run duration of 22.229901047998283 seconds exceeds the specified timeout of 20.0.; 748)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 22.229901047998283 seconds exceeds the specified timeout of 20.0.
[2024-12-09T19:36:02.596+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T19:36:02.961+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T19:36:02.973+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T19:39:33.143+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T19:39:33.184+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:39:33.206+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:39:33.208+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T19:39:33.282+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T19:39:33.303+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=74) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T19:39:33.306+0000] {standard_task_runner.py:72} INFO - Started process 78 to run task
[2024-12-09T19:39:33.314+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '61', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpkbs1hptk']
[2024-12-09T19:39:33.326+0000] {standard_task_runner.py:105} INFO - Job 61: Subtask check_api_online
[2024-12-09T19:39:33.467+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T19:39:34.075+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T19:39:34.086+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T19:39:34.091+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T19:39:34.101+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 19:39:33.185281+00:00
[2024-12-09T19:39:34.110+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T19:39:34.114+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T19:39:34.127+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T19:39:34.131+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:39:34.190+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:39:34.700+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:39:34.701+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:39:39.703+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:39:39.711+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:39:40.139+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:39:40.140+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:39:45.141+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:39:45.150+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:39:45.586+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:39:45.587+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:39:50.593+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:39:50.600+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:39:51.009+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:39:51.010+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:39:56.011+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:39:56.018+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:39:56.449+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:39:56.450+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:39:56.451+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 22.320346751002944 seconds exceeds the specified timeout of 20.0.
[2024-12-09T19:39:56.465+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T19:39:56.465+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 19:39:33.185281+00:00 end:2024-12-09 19:39:56.464614+00:00 duration:23.279333
[2024-12-09T19:39:56.466+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 19:39:27.923263+00:00. externally triggered: False>
[2024-12-09T19:39:56.466+0000] {logging_mixin.py:190} INFO - Failure caused by Sensor has timed out; run duration of 22.320346751002944 seconds exceeds the specified timeout of 20.0.
[2024-12-09T19:39:56.467+0000] {taskinstance.py:1225} INFO - Immediate failure requested. Marking task as FAILED. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T193933, end_date=20241209T193956
[2024-12-09T19:39:56.486+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T19:39:56.487+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 61 for task check_api_online (Sensor has timed out; run duration of 22.320346751002944 seconds exceeds the specified timeout of 20.0.; 78)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 22.320346751002944 seconds exceeds the specified timeout of 20.0.
[2024-12-09T19:39:56.530+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T19:39:56.722+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T19:39:56.729+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T19:45:43.990+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T19:45:44.009+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:45:44.019+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:45:44.019+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T19:45:44.034+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T19:45:44.041+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=160) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T19:45:44.043+0000] {standard_task_runner.py:72} INFO - Started process 162 to run task
[2024-12-09T19:45:44.043+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '63', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpehb3h2ll']
[2024-12-09T19:45:44.045+0000] {standard_task_runner.py:105} INFO - Job 63: Subtask check_api_online
[2024-12-09T19:45:44.096+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T19:45:44.381+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T19:45:44.383+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T19:45:44.383+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T19:45:44.384+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 19:45:44.010487+00:00
[2024-12-09T19:45:44.385+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T19:45:44.385+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T19:45:44.386+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T19:45:44.387+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:45:44.397+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:45:44.985+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:45:44.986+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:45:49.988+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:45:49.998+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:45:50.375+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:45:50.376+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:45:55.377+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:45:55.384+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:45:55.799+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:45:55.800+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:00.799+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:00.808+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:01.242+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:01.243+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:06.245+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:06.255+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:06.673+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:06.674+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:11.675+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:11.682+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:12.122+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:12.123+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:17.124+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:17.152+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:17.605+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:17.606+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:22.608+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:22.617+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:23.037+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:23.040+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:28.046+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:28.053+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:28.492+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:28.493+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:33.494+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:33.500+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:33.936+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:33.937+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:38.938+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:38.945+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:39.408+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:39.409+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:44.411+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:46:44.428+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:46:44.802+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:46:44.803+0000] {http.py:205} ERROR - {"cod":"404","message":"Internal error"}
[2024-12-09T19:46:44.804+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 60.42073915999936 seconds exceeds the specified timeout of 60.0.
[2024-12-09T19:46:44.814+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T19:46:44.815+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 19:45:44.010487+00:00 end:2024-12-09 19:46:44.814017+00:00 duration:60.80353
[2024-12-09T19:46:44.815+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 19:45:42.112197+00:00. externally triggered: False>
[2024-12-09T19:46:44.815+0000] {logging_mixin.py:190} INFO - Failure caused by Sensor has timed out; run duration of 60.42073915999936 seconds exceeds the specified timeout of 60.0.
[2024-12-09T19:46:44.816+0000] {taskinstance.py:1225} INFO - Immediate failure requested. Marking task as FAILED. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T194544, end_date=20241209T194644
[2024-12-09T19:46:44.831+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T19:46:44.831+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 63 for task check_api_online (Sensor has timed out; run duration of 60.42073915999936 seconds exceeds the specified timeout of 60.0.; 162)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 60.42073915999936 seconds exceeds the specified timeout of 60.0.
[2024-12-09T19:46:44.887+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T19:46:45.053+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T19:46:45.060+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T19:50:33.020+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T19:50:33.048+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:50:33.063+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T19:50:33.064+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T19:50:33.087+0000] {taskinstance.py:2889} INFO - Executing <Task(HttpSensor): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T19:50:33.096+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=227) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T19:50:33.098+0000] {standard_task_runner.py:72} INFO - Started process 231 to run task
[2024-12-09T19:50:33.099+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '65', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpmdx_gwe3']
[2024-12-09T19:50:33.101+0000] {standard_task_runner.py:105} INFO - Job 65: Subtask check_api_online
[2024-12-09T19:50:33.163+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T19:50:33.523+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T19:50:33.529+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T19:50:33.530+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T19:50:33.531+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 19:50:33.049715+00:00
[2024-12-09T19:50:33.532+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T19:50:33.532+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T19:50:33.533+0000] {baseoperator.py:416} WARNING - HttpSensor.execute cannot be called outside TaskInstance!
[2024-12-09T19:50:33.534+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:50:33.547+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:50:34.064+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:50:34.068+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:50:39.070+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:50:39.078+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:50:39.519+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:50:39.524+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:50:44.525+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:50:44.546+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:50:44.947+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:50:44.948+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:50:49.949+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:50:49.959+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:50:50.386+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:50:50.387+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:50:55.388+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:50:55.395+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:50:55.810+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:50:55.811+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:00.810+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:51:00.818+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:51:01.249+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:51:01.250+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:06.252+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:51:06.259+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:51:06.677+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:51:06.678+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:11.679+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:51:11.690+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:51:12.147+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:51:12.148+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:17.150+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:51:17.157+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:51:17.567+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:51:17.568+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:22.569+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:51:22.580+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:51:23.009+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:51:23.009+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:28.008+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:51:28.017+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:51:28.436+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:51:28.437+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:33.438+0000] {http.py:137} INFO - Poking: https://api.openweathermap.org/data/2.5/weather?q=Portland&appid=dd24fafbe11ff5c183032972a933481d
[2024-12-09T19:51:33.447+0000] {base.py:84} INFO - Retrieving connection 'open_weather_api'
[2024-12-09T19:51:33.870+0000] {http.py:204} ERROR - HTTP error: Not Found
[2024-12-09T19:51:33.871+0000] {http.py:205} ERROR - <html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>openresty</center>
</body>
</html>

[2024-12-09T19:51:33.872+0000] {taskinstance.py:3311} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 60.342367580997234 seconds exceeds the specified timeout of 60.0.
[2024-12-09T19:51:33.880+0000] {logging_mixin.py:190} INFO - Task instance in failure state
[2024-12-09T19:51:33.881+0000] {logging_mixin.py:190} INFO - Task start:2024-12-09 19:50:33.049715+00:00 end:2024-12-09 19:51:33.880359+00:00 duration:60.830644
[2024-12-09T19:51:33.881+0000] {logging_mixin.py:190} INFO - Task:<Task(HttpSensor): check_api_online> dag:<DAG: weather_data_pipeline> dagrun:<DagRun weather_data_pipeline @ 2024-12-08 00:00:00+00:00: scheduled__2024-12-08T00:00:00+00:00, state:running, queued_at: 2024-12-09 19:50:29.806080+00:00. externally triggered: False>
[2024-12-09T19:51:33.882+0000] {logging_mixin.py:190} INFO - Failure caused by Sensor has timed out; run duration of 60.342367580997234 seconds exceeds the specified timeout of 60.0.
[2024-12-09T19:51:33.882+0000] {taskinstance.py:1225} INFO - Immediate failure requested. Marking task as FAILED. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T195033, end_date=20241209T195133
[2024-12-09T19:51:33.898+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T19:51:33.899+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 65 for task check_api_online (Sensor has timed out; run duration of 60.342367580997234 seconds exceeds the specified timeout of 60.0.; 231)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3005, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3159, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3183, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/http/sensors/http.py", line 160, in execute
    super().execute(context=context)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 417, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/sensors/base.py", line 323, in execute
    raise AirflowSensorTimeout(message)
airflow.exceptions.AirflowSensorTimeout: Sensor has timed out; run duration of 60.342367580997234 seconds exceeds the specified timeout of 60.0.
[2024-12-09T19:51:33.945+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2024-12-09T19:51:34.140+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-09T19:51:34.146+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T20:06:46.435+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T20:06:46.465+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T20:06:46.478+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T20:06:46.479+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T20:06:46.501+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T20:06:46.511+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=428) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T20:06:46.513+0000] {standard_task_runner.py:72} INFO - Started process 432 to run task
[2024-12-09T20:06:46.514+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '68', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmp0_zxp4ac']
[2024-12-09T20:06:46.516+0000] {standard_task_runner.py:105} INFO - Job 68: Subtask check_api_online
[2024-12-09T20:06:46.593+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T20:06:47.079+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T20:06:47.083+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T20:06:47.084+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T20:06:47.085+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 20:06:46.466744+00:00
[2024-12-09T20:06:47.087+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T20:06:47.088+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T20:06:47.508+0000] {logging_mixin.py:190} INFO - API is online.
[2024-12-09T20:06:47.509+0000] {python.py:240} INFO - Done. Returned value was: True
[2024-12-09T20:06:47.549+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T20:06:47.550+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T200646, end_date=20241209T200647
[2024-12-09T20:06:47.566+0000] {logging_mixin.py:190} INFO - Task instance in success state
[2024-12-09T20:06:47.567+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: running
[2024-12-09T20:06:47.567+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline queued_at:2024-12-09 20:06:41.678333+00:00
[2024-12-09T20:06:47.568+0000] {logging_mixin.py:190} INFO - Task hostname:4ccd8b9315ad operator:PythonOperator
[2024-12-09T20:06:47.613+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2024-12-09T20:06:47.692+0000] {taskinstance.py:3895} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-12-09T20:06:47.695+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-09T20:13:05.831+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T20:13:05.886+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T20:13:05.915+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [queued]>
[2024-12-09T20:13:05.916+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-09T20:13:05.965+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): check_api_online> on 2024-12-08 00:00:00+00:00
[2024-12-09T20:13:05.985+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=562) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-12-09T20:13:05.989+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'weather_data_pipeline', 'check_api_online', 'scheduled__2024-12-08T00:00:00+00:00', '--job-id', '83', '--raw', '--subdir', 'DAGS_FOLDER/portland_weather_data_pipeline.py', '--cfg-path', '/tmp/tmpo3rn3mpo']
[2024-12-09T20:13:05.994+0000] {standard_task_runner.py:72} INFO - Started process 564 to run task
[2024-12-09T20:13:05.994+0000] {standard_task_runner.py:105} INFO - Job 83: Subtask check_api_online
[2024-12-09T20:13:06.199+0000] {task_command.py:467} INFO - Running <TaskInstance: weather_data_pipeline.check_api_online scheduled__2024-12-08T00:00:00+00:00 [running]> on host 4ccd8b9315ad
[2024-12-09T20:13:06.986+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='weather_data_pipeline' AIRFLOW_CTX_TASK_ID='check_api_online' AIRFLOW_CTX_EXECUTION_DATE='2024-12-08T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-08T00:00:00+00:00'
[2024-12-09T20:13:06.991+0000] {logging_mixin.py:190} INFO - Task instance is in running state
[2024-12-09T20:13:06.993+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: queued
[2024-12-09T20:13:06.994+0000] {logging_mixin.py:190} INFO - Current task name:check_api_online state:running start_date:2024-12-09 20:13:05.888404+00:00
[2024-12-09T20:13:06.995+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline and current dag run status:running
[2024-12-09T20:13:06.995+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T20:13:07.406+0000] {logging_mixin.py:190} INFO - API is online.
[2024-12-09T20:13:07.408+0000] {python.py:240} INFO - Done. Returned value was: True
[2024-12-09T20:13:07.446+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-09T20:13:07.447+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=weather_data_pipeline, task_id=check_api_online, run_id=scheduled__2024-12-08T00:00:00+00:00, execution_date=20241208T000000, start_date=20241209T201305, end_date=20241209T201307
[2024-12-09T20:13:07.467+0000] {logging_mixin.py:190} INFO - Task instance in success state
[2024-12-09T20:13:07.468+0000] {logging_mixin.py:190} INFO -  Previous state of the Task instance: running
[2024-12-09T20:13:07.468+0000] {logging_mixin.py:190} INFO - Dag name:weather_data_pipeline queued_at:2024-12-09 20:13:03.667018+00:00
[2024-12-09T20:13:07.469+0000] {logging_mixin.py:190} INFO - Task hostname:4ccd8b9315ad operator:PythonOperator
[2024-12-09T20:13:07.531+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2024-12-09T20:13:07.593+0000] {taskinstance.py:3895} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-12-09T20:13:07.597+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
